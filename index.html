<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>SWITZELINT CDE</title>
  <style>
    body { font-family: Arial; margin: 0; background: #f4f6f8; }
    header { background: #0a1e3f; color: white; padding: 10px 20px; }
    nav button { margin-right: 10px; }
    .container { padding: 20px; }
    .hidden { display: none; }
    .board { display: flex; gap: 10px; }
    .column { background: #fff; padding: 10px; width: 33%; border-radius: 6px; }
    .task { background: #e3e7ee; padding: 8px; margin-bottom: 6px; border-radius: 4px; }
  </style>
</head>

<body>

<header>
  <h2>SWITZELINT CDE</h2>
  <button onclick="logout()">Logout</button>
</header>

<div class="container">

<!-- LOGIN -->
<div id="login">
  <h3>Admin Login</h3>
  <input id="user" placeholder="Username"><br><br>
  <input id="pass" type="password" placeholder="Password"><br><br>
  <button onclick="login()">Login</button>
</div>

<!-- APP -->
<div id="app" class="hidden">

  <h3>Projects</h3>
  <input id="projectName" placeholder="New Project Name">
  <button onclick="addProject()">Add Project</button>
  <ul id="projectList"></ul>

  <hr>

  <div id="projectArea" class="hidden">

    <h3 id="currentProject"></h3>

    <!-- TEAMS -->
    <h4>Teams</h4>
    <input id="teamName" placeholder="Team Name">
    <button onclick="addTeam()">Add Team</button>
    <ul id="teamList"></ul>

    <hr>

    <!-- SPRINT -->
    <h4>Sprint</h4>
    <input id="sprintName" placeholder="Sprint Name">
    <button onclick="addSprint()">Add Sprint</button>
    <ul id="sprintList"></ul>

    <hr>

    <!-- TASK -->
    <h4>Add Task</h4>
    <input id="taskName" placeholder="Task Name">
    <select id="taskTeam"></select>
    <button onclick="addTask()">Add Task</button>

    <h4>Kanban Board</h4>
    <div class="board">
      <div class="column"><h5>To Do</h5><div id="todo"></div></div>
      <div class="column"><h5>Doing</h5><div id="doing"></div></div>
      <div class="column"><h5>Done</h5><div id="done"></div></div>
    </div>

  </div>
</div>

<script>
/* ---------- AUTH ---------- */
function login() {
  if (user.value === "Admin" && pass.value === "Admin") {
    loginDiv.style.display = "none";
    app.classList.remove("hidden");
    load();
  } else alert("Wrong login");
}

function logout() {
  location.reload();
}

/* ---------- DATA ---------- */
let data = JSON.parse(localStorage.getItem("switzelint")) || { projects: [] };
let currentProject = null;

function save() {
  localStorage.setItem("switzelint", JSON.stringify(data));
}

/* ---------- PROJECTS ---------- */
function addProject() {
  data.projects.push({ name: projectName.value, teams: [], tasks: [], sprints: [] });
  projectName.value = "";
  save(); renderProjects();
}

function selectProject(i) {
  currentProject = data.projects[i];
  projectArea.classList.remove("hidden");
  currentProjectEl.innerText = currentProject.name;
  renderTeams(); renderTasks(); renderSprints();
}

function renderProjects() {
  projectList.innerHTML = "";
  data.projects.forEach((p, i) => {
    projectList.innerHTML += `<li><button onclick="selectProject(${i})">${p.name}</button></li>`;
  });
}

/* ---------- TEAMS ---------- */
function addTeam() {
  currentProject.teams.push(teamName.value);
  teamName.value = "";
  save(); renderTeams();
}

function renderTeams() {
  teamList.innerHTML = "";
  taskTeam.innerHTML = "";
  currentProject.teams.forEach(t => {
    teamList.innerHTML += `<li>${t}</li>`;
    taskTeam.innerHTML += `<option>${t}</option>`;
  });
}

/* ---------- SPRINT ---------- */
function addSprint() {
  currentProject.sprints.push(sprintName.value);
  sprintName.value = "";
  save(); renderSprints();
}

function renderSprints() {
  sprintList.innerHTML = "";
  currentProject.sprints.forEach(s => sprintList.innerHTML += `<li>${s}</li>`);
}

/* ---------- TASKS ---------- */
function addTask() {
  currentProject.tasks.push({ name: taskName.value, team: taskTeam.value, status: "todo" });
  taskName.value = "";
  save(); renderTasks();
}

function moveTask(i, status) {
  currentProject.tasks[i].status = status;
  save(); renderTasks();
}

function renderTasks() {
  todo.innerHTML = doing.innerHTML = done.innerHTML = "";
  currentProject.tasks.forEach((t, i) => {
    let html = `<div class="task">${t.name}<br><small>${t.team}</small><br>
      <button onclick="moveTask(${i},'todo')">ToDo</button>
      <button onclick="moveTask(${i},'doing')">Doing</button>
      <button onclick="moveTask(${i},'done')">Done</button></div>`;
    document.getElementById(t.status).innerHTML += html;
  });
}

/* ---------- INIT ---------- */
function load() { renderProjects(); }

const loginDiv = document.getElementById("login");
const app = document.getElementById("app");
const currentProjectEl = document.getElementById("currentProject");
</script>

</body>
</html>
