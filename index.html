<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SWITZELINT CDE</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{margin:0;font-family:Segoe UI;background:#f4f6f9}
header{background:#0b1d3a;color:#fff;padding:14px 20px;display:flex;justify-content:space-between}
button{background:#2563eb;color:#fff;border:none;padding:6px 12px;border-radius:4px;cursor:pointer}
input,select{width:100%;padding:6px;margin-bottom:6px}
.hidden{display:none}
.container{padding:20px}
.grid{display:grid;grid-template-columns:280px 1fr;gap:20px}
.card{background:#fff;padding:12px;border-radius:6px;box-shadow:0 1px 3px rgba(0,0,0,.1)}
h4{margin-top:0}
ul{padding-left:18px}
.board{display:grid;grid-template-columns:repeat(3,1fr);gap:10px}
.column{background:#eef1f6;padding:10px;border-radius:6px}
.task{background:#fff;padding:8px;margin-bottom:6px;border-radius:4px;font-size:13px}
.task select{margin-top:4px}
.log{font-size:12px;border-bottom:1px solid #ddd;padding:4px 0}
small{color:#555}
</style>
</head>

<body>

<header>
<strong>SWITZELINT CDE</strong>
<button onclick="logout()">Logout</button>
</header>

<div class="container">

<!-- LOGIN -->
<div id="login">
<div class="card" style="max-width:320px;margin:auto">
<h3>Admin Login</h3>
<input id="user" placeholder="Username">
<input id="pass" type="password" placeholder="Password">
<button onclick="login()">Login</button>
</div>
</div>

<!-- APP -->
<div id="app" class="hidden">
<div class="grid">

<!-- LEFT -->
<div class="card">
<h4>Projects</h4>
<ul id="projectList"></ul>

<input id="newProject" placeholder="New Project Name">
<button onclick="addProject()">Add Project</button>

<hr>

<h4>Teams</h4>
<ul id="teamList"></ul>
<input id="newTeam" placeholder="New Team Name">
<button onclick="addTeam()">Add Team</button>

<hr>

<h4>Audit Log</h4>
<div id="audit"></div>
</div>

<!-- RIGHT -->
<div class="card">
<h2 id="projectTitle"></h2>

<h4>Add Task</h4>
<input id="taskName" placeholder="Task name">
<select id="taskTeam"></select>
<button onclick="addTask()">Add Task</button>

<h4>Kanban Board</h4>
<div class="board">
<div class="column"><h5>To Do</h5><div id="todo"></div></div>
<div class="column"><h5>Doing</h5><div id="doing"></div></div>
<div class="column"><h5>Done</h5><div id="done"></div></div>
</div>

<h4>ISO 19650 CDE</h4>
<ul>
<li><strong>WIP</strong></li>
<li><strong>SHARED</strong></li>
<li><strong>PUBLISHED</strong></li>
<li><strong>ARCHIVED</strong></li>
</ul>

</div>

</div>
</div>

<script>
/* ===== STORAGE ===== */
let data=JSON.parse(localStorage.getItem("switzelint"))||{projects:[]};
let currentProjectIndex=null;

function save(){localStorage.setItem("switzelint",JSON.stringify(data));}

/* ===== AUTH ===== */
function login(){
if(user.value==="Admin" && pass.value==="Admin"){
loginDiv.style.display="none";
app.classList.remove("hidden");
renderProjects();
log("Admin logged in");
}else alert("Invalid login");
}
function logout(){localStorage.removeItem("switzelint");location.reload();}

/* ===== PROJECTS ===== */
function renderProjects(){
projectList.innerHTML="";
data.projects.forEach((p,i)=>{
projectList.innerHTML+=`<li><button onclick="selectProject(${i})">${p.name}</button></li>`;
});
}

function addProject(){
if(!newProject.value)return;
data.projects.push({name:newProject.value,teams:[],tasks:[]});
newProject.value="";
save();renderProjects();
log("Project added");
}

function selectProject(i){
currentProjectIndex=i;
const p=data.projects[i];
projectTitle.innerText=p.name;
renderTeams();renderTasks();renderTeamSelect();
log("Project opened: "+p.name);
}

/* ===== TEAMS ===== */
function renderTeams(){
teamList.innerHTML="";
data.projects[currentProjectIndex].teams.forEach(t=>teamList.innerHTML+=`<li>${t}</li>`);
}

function addTeam(){
if(!newTeam.value)return;
data.projects[currentProjectIndex].teams.push(newTeam.value);
newTeam.value="";
save();renderTeams();renderTeamSelect();
log("Team added");
}

function renderTeamSelect(){
taskTeam.innerHTML="";
data.projects[currentProjectIndex].teams.forEach(t=>{
taskTeam.innerHTML+=`<option>${t}</option>`;
});
}

/* ===== TASKS ===== */
function addTask(){
if(!taskName.value)return;
data.projects[currentProjectIndex].tasks.push({
name:taskName.value,team:taskTeam.value,status:"todo"
});
taskName.value="";
save();renderTasks();
log("Task added");
}

function renderTasks(){
todo.innerHTML=doing.innerHTML=done.innerHTML="";
data.projects[currentProjectIndex].tasks.forEach((t,i)=>{
document.getElementById(t.status).innerHTML+=`
<div class="task">
${t.name}<br><small>${t.team}</small>
<select onchange="moveTask(${i},this.value)">
<option ${t.status=="todo"?"selected":""}>todo</option>
<option ${t.status=="doing"?"selected":""}>doing</option>
<option ${t.status=="done"?"selected":""}>done</option>
</select>
</div>`;
});
}

function moveTask(i,status){
data.projects[currentProjectIndex].tasks[i].status=status;
save();renderTasks();
log("Task moved to "+status);
}

/* ===== AUDIT ===== */
function log(msg){
audit.innerHTML=`<div class="log">${new Date().toLocaleTimeString()} â€” ${msg}</div>`+audit.innerHTML;
}

/* ===== INIT ===== */
const loginDiv=document.getElementById("login");
const app=document.getElementById("app");
</script>

</body>
</html>
