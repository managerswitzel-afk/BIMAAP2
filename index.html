<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SWITZELINT â€“ BIM LOD Planner</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
*{box-sizing:border-box}
body{margin:0;font-family:Arial;background:#f3f4f6}
.app{display:flex;height:100vh}
.sidebar{width:240px;background:#1f2933;color:#fff;padding:20px}
.sidebar h1{font-size:18px;margin:0}
.sidebar h2{font-size:13px;color:#cbd5e1;margin:5px 0 20px}
.sidebar button{width:100%;padding:10px;margin-bottom:8px;border:none;background:#374151;color:#fff;border-radius:4px;cursor:pointer}

.main{flex:1;padding:20px;overflow:auto}
.topbar{display:flex;justify-content:space-between;margin-bottom:15px}
.topbar button{padding:8px 14px;border:none;border-radius:4px;background:#2563eb;color:#fff;cursor:pointer}

.board{display:flex;gap:12px}
.column{background:#e5e7eb;width:260px;padding:10px;border-radius:6px}
.card{background:#fff;padding:10px;margin-bottom:8px;border-left:4px solid #2563eb;border-radius:4px;cursor:pointer}
.card small{display:block;color:#555}

table{width:100%;background:#fff;border-collapse:collapse}
th,td{padding:10px;border:1px solid #ddd;text-align:left}

.modal{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.4);display:none;align-items:center;justify-content:center}
.modal-content{background:#fff;padding:20px;width:320px;border-radius:6px}
.modal-content input,select{width:100%;padding:8px;margin-bottom:8px}
.modal-content button{width:100%;padding:10px;margin-top:5px}
</style>
</head>

<body>
<div id="app"></div>

<div class="modal" id="taskModal">
  <div class="modal-content">
    <h3>Task</h3>
    <input id="name" placeholder="Task name">
    <select id="discipline">
      <option>ARC</option><option>STR</option><option>MEP</option>
    </select>
    <input id="lodCurrent" placeholder="LOD Current">
    <input id="lodTarget" placeholder="LOD Target">
    <select id="status">
      <option>Backlog</option>
      <option>In Progress</option>
      <option>Review</option>
      <option>Approved</option>
    </select>
    <input id="team" placeholder="Assigned Team">
    <input id="due" type="date">
    <button onclick="saveTask()">Save</button>
    <button onclick="deleteTask()" style="background:#ef4444;color:#fff">Delete</button>
    <button onclick="closeModal()">Close</button>
  </div>
</div>

<script>
let view="kanban";
let editIndex=null;
let tasks=JSON.parse(localStorage.getItem("tasks")||"[]");

const app=document.getElementById("app");

function render(){
app.innerHTML=`
<div class="app">
<div class="sidebar">
<h1>SWITZELINT</h1>
<h2>BIM LOD Planner</h2>
<button onclick="openNew()">+ New Task</button>
</div>

<div class="main">
<div class="topbar">
<div>
<button onclick="setView('kanban')">Kanban</button>
<button onclick="setView('list')">List</button>
</div>
<strong>LOD Planning</strong>
</div>
${view==="kanban"?kanban():list()}
</div>
</div>`;
}

function kanban(){
const cols=["Backlog","In Progress","Review","Approved"];
return `<div class="board">`+cols.map(c=>`
<div class="column"><h3>${c}</h3>
${tasks.filter(t=>t.status===c).map((t,i)=>`
<div class="card" onclick="edit(${i})">
${t.name}
<small>${t.discipline} | ${t.team}</small>
<small>LOD ${t.lodCurrent}/${t.lodTarget}</small>
</div>`).join("")}
</div>`).join("")+`</div>`;
}

function list(){
return `<table>
<tr><th>Task</th><th>Discipline</th><th>Status</th><th>Team</th><th>LOD</th></tr>
${tasks.map((t,i)=>`
<tr onclick="edit(${i})">
<td>${t.name}</td><td>${t.discipline}</td><td>${t.status}</td>
<td>${t.team}</td><td>${t.lodCurrent}/${t.lodTarget}</td>
</tr>`).join("")}
</table>`;
}

function setView(v){view=v;render()}

function openNew(){
editIndex=null;
document.getElementById("taskModal").style.display="flex";
document.querySelectorAll("#taskModal input,select").forEach(e=>e.value="");
}

function edit(i){
editIndex=i;
const t=tasks[i];
["name","discipline","lodCurrent","lodTarget","status","team","due"]
.forEach(id=>document.getElementById(id).value=t[id]||"");
document.getElementById("taskModal").style.display="flex";
}

function saveTask(){
const t={
name:name.value,discipline:discipline.value,
lodCurrent:lodCurrent.value,lodTarget:lodTarget.value,
status:status.value,team:team.value,due:due.value
};
editIndex===null?tasks.push(t):tasks[editIndex]=t;
localStorage.setItem("tasks",JSON.stringify(tasks));
closeModal();render();
}

function deleteTask(){
if(editIndex!==null){
tasks.splice(editIndex,1);
localStorage.setItem("tasks",JSON.stringify(tasks));
}
closeModal();render();
}

function closeModal(){document.getElementById("taskModal").style.display="none"}

render();
</script>
</body>
</html>
